<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADExplorer to BloodHound Converter</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background-color: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .section { margin: 20px 0; padding: 15px; background: #ecf0f1; border-radius: 5px; }
        .code { background: #2c3e50; color: #ecf0f1; padding: 10px; border-radius: 3px; font-family: 'Courier New', monospace; }
        .success { color: #27ae60; font-weight: bold; }
        .warning { color: #f39c12; font-weight: bold; }
        .error { color: #e74c3c; font-weight: bold; }
        button { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #2980b9; }
        input[type="file"] { margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ADExplorer to BloodHound Converter</h1>
        
        <div class="section">
            <h2>üöÄ Quick Start</h2>
            <p>This web-based converter helps you work around PowerShell execution policy issues.</p>
            
            <h3>Method 1: Unblock Scripts</h3>
            <p>Run this command in PowerShell as Administrator:</p>
            <div class="code">Get-ChildItem -Path "." -Filter "*.ps1" | Unblock-File</div>
            
            <h3>Method 2: Use CMD Batch File</h3>
            <p>Use the provided batch file which bypasses PowerShell execution policy:</p>
            <div class="code">convert-adexplorer.cmd yourfile.dat output.json</div>
            
            <h3>Method 3: PowerShell with Bypass</h3>
            <p>Run PowerShell with execution policy bypass:</p>
            <div class="code">powershell.exe -ExecutionPolicy Bypass -File "Convert-ADExplorer.ps1" -InputFile "yourfile.dat"</div>
        </div>
        
        <div class="section">
            <h2>üìÅ File Converter</h2>
            <p>Select your ADExplorer .dat file to convert:</p>
            <input type="file" id="fileInput" accept=".dat" />
            <button onclick="convertFile()">Convert to BloodHound JSON</button>
            <div id="result"></div>
        </div>
        
        <div class="section">
            <h2>üîß Troubleshooting</h2>
            <h3>Execution Policy Issues</h3>
            <ul>
                <li><strong>Unblock files:</strong> Right-click ‚Üí Properties ‚Üí Unblock</li>
                <li><strong>Use CMD:</strong> The .cmd file bypasses PowerShell policy</li>
                <li><strong>Run as Admin:</strong> PowerShell as Administrator</li>
                <li><strong>Change policy:</strong> <code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</code></li>
            </ul>
            
            <h3>File Format Issues</h3>
            <ul>
                <li>Ensure the .dat file is from ADExplorer</li>
                <li>Check file permissions (read access required)</li>
                <li>Verify file is not corrupted</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>üìã Usage Examples</h2>
            <div class="code">
# Basic conversion
.\Convert-ADExplorer.ps1 -InputFile "adexplorer.dat"

# With output file
.\Convert-ADExplorer.ps1 -InputFile "adexplorer.dat" -OutputFile "bloodhound.json"

# Include deleted objects
.\Convert-ADExplorer.ps1 -InputFile "adexplorer.dat" -IncludeDeleted

# Filter object types
.\Convert-ADExplorer.ps1 -InputFile "adexplorer.dat" -ObjectTypes @("User", "Computer", "Group")
            </div>
        </div>
    </div>

    <script>
        function convertFile() {
            const fileInput = document.getElementById('fileInput');
            const result = document.getElementById('result');
            
            if (!fileInput.files[0]) {
                result.innerHTML = '<p class="error">Please select a file first!</p>';
                return;
            }
            
            const file = fileInput.files[0];
            const fileName = file.name;
            const outputName = fileName.replace('.dat', '.json');
            
            result.innerHTML = `
                <p class="success">‚úì File selected: ${fileName}</p>
                <p>To convert this file, run one of these commands:</p>
                <div class="code">
# PowerShell (if execution policy allows)
.\Convert-ADExplorer.ps1 -InputFile "${fileName}" -OutputFile "${outputName}"

# CMD Batch (bypasses execution policy)
convert-adexplorer.cmd "${fileName}" "${outputName}"

# PowerShell with bypass
powershell.exe -ExecutionPolicy Bypass -File "Convert-ADExplorer.ps1" -InputFile "${fileName}" -OutputFile "${outputName}"
                </div>
            `;
        }
    </script>
</body>
</html>
